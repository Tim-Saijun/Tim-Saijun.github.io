{"title":"MySQL的监听地址","uid":"d664b9e10cb55e3238e26b1294b7b2ee","slug":"MySQL的监听地址","date":"2023-01-26T11:43:43.000Z","updated":"2024-02-22T03:52:13.945Z","comments":true,"path":"api/articles/MySQL的监听地址.json","keywords":"计算机技术,大数据,人工智能","cover":null,"content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>在某云的ECS上搭建了MySQL服务端，防火墙安全组一切正常，却无法远程访问。</p></blockquote>\n<p>本机扫描服务器端口：</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\" onclick=\"copyCode(this)\"></button><span class=\"lang\">shell</span><pre class=\"shiki dracula\" style=\"background-color: #282A36\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #F8F8F2\"> </span><span style=\"color: #50FA7B\">⚡yangz</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">❯❯</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">nmap</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">-sS</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">MD</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">Starting</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Nmap</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">7.93</span><span style=\"color: #F8F8F2\"> ( </span><span style=\"color: #F1FA8C\">https://nmap.org</span><span style=\"color: #F8F8F2\"> ) at 2023-01-26 19:23 中国标准时间</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">Nmap</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">scan</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">report</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">for</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">MD</span><span style=\"color: #F8F8F2\"> </span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">Host</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">is</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">up</span><span style=\"color: #F8F8F2\"> (0.045s </span><span style=\"color: #F1FA8C\">latency</span><span style=\"color: #F8F8F2\">).</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">Not</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">shown:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">996</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">filtered</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">tcp</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">ports</span><span style=\"color: #F8F8F2\"> (no-response)</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">PORT</span><span style=\"color: #F8F8F2\">     </span><span style=\"color: #F1FA8C\">STATE</span><span style=\"color: #F8F8F2\">  </span><span style=\"color: #F1FA8C\">SERVICE</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">22/tcp</span><span style=\"color: #F8F8F2\">   </span><span style=\"color: #F1FA8C\">open</span><span style=\"color: #F8F8F2\">   </span><span style=\"color: #F1FA8C\">ssh</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">80/tcp</span><span style=\"color: #F8F8F2\">   </span><span style=\"color: #F1FA8C\">open</span><span style=\"color: #F8F8F2\">   </span><span style=\"color: #F1FA8C\">http</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">443/tcp</span><span style=\"color: #F8F8F2\">  </span><span style=\"color: #F1FA8C\">closed</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">https</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">3306/tcp</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">closed</span><span style=\"color: #F8F8F2\">   </span><span style=\"color: #F1FA8C\">mysql</span></span></code></pre></div><p>果然，端口是通的，没人监听而已。<br>检查ECS端口使用情况：</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\" onclick=\"copyCode(this)\"></button><span class=\"lang\">shell</span><pre class=\"shiki dracula\" style=\"background-color: #282A36\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #50FA7B\">root@minedl:~#</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">netstat</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">-lntp</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">Active</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Internet</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">connections</span><span style=\"color: #F8F8F2\"> (only </span><span style=\"color: #F1FA8C\">servers</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">Proto</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Recv-Q</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Send-Q</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Local</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Address</span><span style=\"color: #F8F8F2\">           </span><span style=\"color: #F1FA8C\">Foreign</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Address</span><span style=\"color: #F8F8F2\">         </span><span style=\"color: #F1FA8C\">State</span><span style=\"color: #F8F8F2\">       </span><span style=\"color: #F1FA8C\">PID/Program</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">name</span><span style=\"color: #F8F8F2\">    </span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">tcp</span><span style=\"color: #F8F8F2\">        </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">127.0</span><span style=\"color: #F1FA8C\">.0.1:3306</span><span style=\"color: #F8F8F2\">          </span><span style=\"color: #BD93F9\">0.0</span><span style=\"color: #F1FA8C\">.0.0:</span><span style=\"color: #BD93F9; font-style: italic\">*</span><span style=\"color: #F8F8F2\">               </span><span style=\"color: #F1FA8C\">LISTEN</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">24735</span><span style=\"color: #F1FA8C\">/mysqld</span><span style=\"color: #F8F8F2\"> </span></span></code></pre></div><p>mysql绑定到了本地回环测试的地址上，所以无法对外提供服务。做如下配置：</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\" onclick=\"copyCode(this)\"></button><span class=\"lang\">shell</span><pre class=\"shiki dracula\" style=\"background-color: #282A36\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #50FA7B\">vim</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">/etc/mysql/mysql.conf.d/mysqld.cnf</span></span></code></pre></div><p>修改其中的bind-address &#x3D; 0.0.0.0 ，注意不可以直接注释掉，否则会导致如下第二种结果。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\" onclick=\"copyCode(this)\"></button><span class=\"lang\">shell</span><pre class=\"shiki dracula\" style=\"background-color: #282A36\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #50FA7B\">tcp</span><span style=\"color: #F8F8F2\">        </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">127.0</span><span style=\"color: #F1FA8C\">.0.1:3306</span><span style=\"color: #F8F8F2\">          </span><span style=\"color: #BD93F9\">0.0</span><span style=\"color: #F1FA8C\">.0.0:</span><span style=\"color: #BD93F9; font-style: italic\">*</span><span style=\"color: #F8F8F2\">               </span><span style=\"color: #F1FA8C\">LISTEN</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">24735</span><span style=\"color: #F1FA8C\">/mysqld</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #6272A4\">#只监听localhost</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">tcp6</span><span style=\"color: #F8F8F2\">       </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">:::3306</span><span style=\"color: #F8F8F2\">                 </span><span style=\"color: #F1FA8C\">:::</span><span style=\"color: #BD93F9; font-style: italic\">*</span><span style=\"color: #F8F8F2\">                    </span><span style=\"color: #F1FA8C\">LISTEN</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">24794</span><span style=\"color: #F1FA8C\">/mysqld</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #6272A4\">#只监听ipv6，不监听ipv4</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">tcp</span><span style=\"color: #F8F8F2\">        </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">0</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">0.0</span><span style=\"color: #F1FA8C\">.0.0:3306</span><span style=\"color: #F8F8F2\">            </span><span style=\"color: #BD93F9\">0.0</span><span style=\"color: #F1FA8C\">.0.0:</span><span style=\"color: #BD93F9; font-style: italic\">*</span><span style=\"color: #F8F8F2\">               </span><span style=\"color: #F1FA8C\">LISTEN</span><span style=\"color: #F8F8F2\">      </span><span style=\"color: #BD93F9\">24877</span><span style=\"color: #F1FA8C\">/mysqld</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #6272A4\">#监听所有ipv4</span></span></code></pre></div><p>出现结果三，本机访问也成功访问。</p>\n","text":" 在某云的ECS上搭建了MySQL服务端，防火墙安全组一切正常，却无法远程访问。 本机扫描服务器端口： shell ⚡yangz ❯❯ nmap -sS MD ...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"数据库","slug":"数据库","count":1,"path":"api/categories/数据库.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":1,"path":"api/tags/MySQL.json"}],"toc":"","author":{"name":"以太工坊","slug":"blog-author","avatar":"/img/logo.png","link":"/","description":"分享我的课程学习笔记、经验与有趣的小玩意.图片等资源无法加载时请使用代理","socials":{"github":"https://github.com/Tim-Saijun","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"telegram":{"icon":"/img/telegram.svg","link":"https://t.me/tim_run"},"Email":{"icon":"/img/mail.svg","link":"mailto:b@zair.top"},"RSS":{"icon":"/img/rss.svg","link":"/atom.xml"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"Docker导出镜像","uid":"0485b8f7691dafa496f29ff47600c4f0","slug":"Docker导出镜像","date":"2023-01-29T06:54:49.000Z","updated":"2024-02-22T03:52:13.945Z","comments":true,"path":"api/articles/Docker导出镜像.json","keywords":"计算机技术,大数据,人工智能","cover":null,"text":" 主要介绍使用docker export快速导出单个容器镜像。 都说docker有”一次运行，处处使用”的优点，是实现Dev-ops的有力工具，那么本文相关内容...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"大数据","slug":"大数据","count":11,"path":"api/categories/大数据.json"}],"tags":[{"name":"技术贴士","slug":"技术贴士","count":2,"path":"api/tags/技术贴士.json"},{"name":"Docker","slug":"Docker","count":1,"path":"api/tags/Docker.json"}],"author":{"name":"以太工坊","slug":"blog-author","avatar":"/img/logo.png","link":"/","description":"分享我的课程学习笔记、经验与有趣的小玩意.图片等资源无法加载时请使用代理","socials":{"github":"https://github.com/Tim-Saijun","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"telegram":{"icon":"/img/telegram.svg","link":"https://t.me/tim_run"},"Email":{"icon":"/img/mail.svg","link":"mailto:b@zair.top"},"RSS":{"icon":"/img/rss.svg","link":"/atom.xml"}}}}},"next_post":{"title":"模型的评估","uid":"add90185e378e36c94b8bd3e088f97e0","slug":"模型的评估","date":"2023-01-19T13:01:49.000Z","updated":"2024-02-22T03:52:13.965Z","comments":true,"path":"api/articles/模型的评估.json","keywords":"计算机技术,大数据,人工智能","cover":null,"text":" 15e2225780c20263b1094cf2e8d24d28d35d79bf5de03e3538e026674832bddd4c4967768221cf5...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"机器学习","slug":"机器学习","count":5,"path":"api/categories/机器学习.json"}],"tags":[{"name":"学习笔记","slug":"学习笔记","count":17,"path":"api/tags/学习笔记.json"},{"name":"加密","slug":"加密","count":1,"path":"api/tags/加密.json"}],"author":{"name":"以太工坊","slug":"blog-author","avatar":"/img/logo.png","link":"/","description":"分享我的课程学习笔记、经验与有趣的小玩意.图片等资源无法加载时请使用代理","socials":{"github":"https://github.com/Tim-Saijun","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"telegram":{"icon":"/img/telegram.svg","link":"https://t.me/tim_run"},"Email":{"icon":"/img/mail.svg","link":"mailto:b@zair.top"},"RSS":{"icon":"/img/rss.svg","link":"/atom.xml"}}}}}}